<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PancakeSwap V3 ASPECTA Token Swapper</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: #fff;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 30px;
            width: 100%;
            max-width: 800px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            color: #e0e0e0;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .header p {
            font-size: 1.1em;
            color: #c0c0c0;
        }

        .section {
            background-color: rgba(255, 255, 255, 0.08);
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .section h2 {
            font-size: 1.8em;
            margin-bottom: 20px;
            color: #fff;
            border-bottom: 2px solid rgba(255, 255, 255, 0.3);
            padding-bottom: 10px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #e0e0e0;
        }

        .form-group input[type="text"],
        .form-group input[type="number"],
        .form-group select {
            width: calc(100% - 20px);
            padding: 12px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            background-color: rgba(255, 255, 255, 0.15);
            color: #fff;
            font-size: 1em;
            transition: border-color 0.3s ease, background-color 0.3s ease;
        }

        .form-group input[type="text"]::placeholder,
        .form-group input[type="number"]::placeholder {
            color: #ccc;
        }

        .form-group input[type="text"]:focus,
        .form-group input[type="number"]:focus,
        .form-group select:focus {
            border-color: #88bfff;
            background-color: rgba(255, 255, 255, 0.25);
            outline: none;
        }

        .form-group select option {
            background-color: #2575fc;
            color: #fff;
        }

        button {
            background: linear-gradient(45deg, #00c6ff, #0072ff);
            color: #fff;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-size: 1.1em;
            cursor: pointer;
            transition: background 0.3s ease, transform 0.2s ease;
            box-shadow: 0 4px 10px rgba(0, 114, 255, 0.3);
            width: 100%;
        }

        button:hover {
            background: linear-gradient(45deg, #0072ff, #00c6ff);
            transform: translateY(-2px);
        }

        button:active {
            transform: translateY(0);
            box-shadow: 0 2px 5px rgba(0, 114, 255, 0.3);
        }

        .result {
            background-color: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            font-family: 'Courier New', Courier, monospace;
            white-space: pre-wrap;
            word-wrap: break-word;
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #e0e0e0;
        }

        .result.error {
            background-color: rgba(255, 0, 0, 0.2);
            border-color: rgba(255, 0, 0, 0.5);
            color: #ffcccc;
        }

        .result.success {
            background-color: rgba(0, 255, 0, 0.2);
            border-color: rgba(0, 255, 0, 0.5);
            color: #ccffcc;
        }

        .info-card {
            background-color: rgba(255, 255, 255, 0.05);
            border-left: 5px solid #00c6ff;
            padding: 15px;
            margin-bottom: 25px;
            border-radius: 8px;
        }

        .info-card h3 {
            margin-top: 0;
            color: #00c6ff;
        }

        .info-card p {
            font-size: 0.95em;
            color: #c0e0ff;
        }

        .warning {
            background-color: rgba(255, 165, 0, 0.1);
            border-left: 5px solid #ffa500;
            padding: 15px;
            margin-bottom: 25px;
            border-radius: 8px;
            color: #ffcc80;
        }

        .warning h3 {
            margin-top: 0;
            color: #ffa500;
        }

        .warning p {
            font-size: 0.95em;
        }

        /* Responsive adjustments */
        @media (max-width: 600px) {
            .container {
                padding: 20px;
            }

            .header h1 {
                font-size: 2em;
            }

            .section h2 {
                font-size: 1.5em;
            }

            button {
                font-size: 1em;
                padding: 10px 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü•û PancakeSwap V3 ASPECTA Swapper</h1>
            <p>Swap ASPECTA tokens on Binance Smart Chain using PancakeSwap V3</p>
        </div>

        <div class="main-content">
            <div class="info-card">
                <h3>üìã Instructions</h3>
                <p>This tool allows you to interact with the ASPECTA token on Binance Smart Chain through PancakeSwap V3. 
                   Start by checking token information and pool availability, then get quotes before performing swaps.</p>
            </div>

            <div class="warning">
                <h3>‚ö†Ô∏è Important Security Notice</h3>
                <p>This application is for educational and testing purposes only. Do NOT use your main wallet's private key.
                   Always use a burner wallet with minimal funds for testing. Your private key is handled client-side
                   and is NOT sent to the server, but exercise extreme caution.</p>
            </div>

            <!-- Token Information -->
            <div class="section token-info">
                <h2>ASPECTA Token Information</h2>
                <button onclick="getTokenInfo()">Get ASPECTA Token Info</button>
                <div id="token-info-result" class="result"></div>
            </div>

            <!-- Pool Information -->
            <div class="section pool-info">
                <h2>Pool Information</h2>
                <button onclick="getPoolInfo()">Find PancakeSwap V3 Pools</button>
                <div id="pool-info-result" class="result"></div>
            </div>

            <!-- Get Swap Quote -->
            <div class="section get-quote">
                <h2>Get Swap Quote</h2>
                <div class="form-group">
                    <label for="quote-amount">Amount of ASPECTA to swap:</label>
                    <input type="number" id="quote-amount" placeholder="e.g., 100" step="0.000001">
                </div>
                <div class="form-group">
                    <label for="quote-fee">Fee Tier:</label>
                    <select id="quote-fee">
                        <option value="100">0.01% (100)</option>
                        <option value="500">0.05% (500)</option>
                        <option value="2500">0.25% (2500)</option>
                        <option value="10000" selected>1% (10000) - Has Liquidity</option>
                    </select>
                </div>
                <button onclick="getQuote()">Get Quote</button>
                <div id="quote-result" class="result"></div>
            </div>

            <!-- Approve Token -->
            <div class="section approve-token">
                <h2>Approve Token</h2>
                <div class="form-group">
                    <label for="approve-private-key">Private Key:</label>
                    <input type="text" id="approve-private-key" placeholder="Your private key (never share!)">
                </div>
                <div class="form-group">
                    <label for="approve-address">Your Wallet Address:</label>
                    <input type="text" id="approve-address" placeholder="0x...">
                </div>
                <div class="form-group">
                    <label for="approve-amount">Amount to Approve (ASPECTA):</label>
                    <input type="number" id="approve-amount" placeholder="e.g., 1000" step="0.000001">
                </div>
                <button onclick="approveToken()">Approve Token</button>
                <div id="approve-result" class="result"></div>
            </div>

            <!-- Swap Token -->
            <div class="section swap-token">
                <h2>Swap Token</h2>
                <div class="form-group">
                    <label for="swap-private-key">Private Key:</label>
                    <input type="text" id="swap-private-key" placeholder="Your private key (never share!)">
                </div>
                <div class="form-group">
                    <label for="swap-address">Your Wallet Address:</label>
                    <input type="text" id="swap-address" placeholder="0x...">
                </div>
                <div class="form-group">
                    <label for="swap-amount-in">Amount of ASPECTA to swap:</label>
                    <input type="number" id="swap-amount-in" placeholder="e.g., 100" step="0.000001">
                </div>
                <div class="form-group">
                    <label for="swap-amount-out-min">Minimum WBNB to receive:</label>
                    <input type="number" id="swap-amount-out-min" placeholder="e.g., 0.001" step="0.000001">
                </div>
                <div class="form-group">
                    <label for="swap-fee">Fee Tier:</label>
                    <select id="swap-fee">
                        <option value="100">0.01% (100)</option>
                        <option value="500">0.05% (500)</option>
                        <option value="2500">0.25% (2500)</option>
                        <option value="10000" selected>1% (10000) - Has Liquidity</option>
                    </select>
                </div>
                <button onclick="swapToken()">Swap Token</button>
                <div id="swap-result" class="result"></div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE_URL = window.location.origin + '/api';

        async function callApi(endpoint, method = 'GET', data = null) {
            const options = {
                method: method,
                headers: {
                    'Content-Type': 'application/json',
                },
            };
            if (data) {
                options.body = JSON.stringify(data);
            }

            try {
                const response = await fetch(`${API_BASE_URL}${endpoint}`, options);
                const result = await response.json();
                if (!response.ok) {
                    throw new Error(result.error || 'Something went wrong');
                }
                return result;
            } catch (error) {
                console.error(`API Call Error (${endpoint}):`, error);
                throw error;
            }
        }

        function displayResult(elementId, data, isError = false) {
            const resultDiv = document.getElementById(elementId);
            resultDiv.innerHTML = ''; // Clear previous content
            resultDiv.className = 'result'; // Reset class

            if (isError) {
                resultDiv.classList.add('error');
                resultDiv.textContent = `Error: ${data.message || data}`; // Display error message
            } else {
                resultDiv.classList.add('success');
                resultDiv.textContent = JSON.stringify(data, null, 2);
            }
        }

        async function getTokenInfo() {
            try {
                const data = await callApi('/token-info');
                displayResult('token-info-result', data);
            } catch (error) {
                displayResult('token-info-result', error, true);
            }
        }

        async function getPoolInfo() {
            try {
                const data = await callApi('/pool-info');
                displayResult('pool-info-result', data);
            } catch (error) {
                displayResult('pool-info-result', error, true);
            }
        }

        async function getQuote() {
            try {
                const amount = parseFloat(document.getElementById('quote-amount').value);
                const fee = parseInt(document.getElementById('quote-fee').value); // Ensure fee is an integer

                if (isNaN(amount) || amount <= 0) {
                    displayResult('quote-result', 'Please enter a valid amount.', true);
                    return;
                }

                const data = await callApi('/quote', 'POST', { amount_in: amount, fee: fee });
                displayResult('quote-result', data);
            } catch (error) {
                displayResult('quote-result', error, true);
            }
        }

        async function approveToken() {
            try {
                const privateKey = document.getElementById('approve-private-key').value;
                const accountAddress = document.getElementById('approve-address').value;
                const amount = parseFloat(document.getElementById('approve-amount').value);

                if (!privateKey || !accountAddress || isNaN(amount) || amount <= 0) {
                    displayResult('approve-result', 'Please fill all fields with valid data.', true);
                    return;
                }

                const data = await callApi('/approve', 'POST', {
                    private_key: privateKey,
                    account_address: accountAddress,
                    amount: amount
                });
                displayResult('approve-result', data);
            } catch (error) {
                displayResult('approve-result', error, true);
            }
        }

        async function swapToken() {
            try {
                const privateKey = document.getElementById('swap-private-key').value;
                const accountAddress = document.getElementById('swap-address').value;
                const amountIn = parseFloat(document.getElementById('swap-amount-in').value);
                const amountOutMin = parseFloat(document.getElementById('swap-amount-out-min').value);
                const fee = parseInt(document.getElementById('swap-fee').value); // Ensure fee is an integer

                if (!privateKey || !accountAddress || isNaN(amountIn) || amountIn <= 0 || isNaN(amountOutMin) || amountOutMin < 0 || isNaN(fee)) {
                    displayResult('swap-result', 'Please fill all fields with valid data.', true);
                    return;
                }

                const data = await callApi('/swap', 'POST', {
                    private_key: privateKey,
                    account_address: accountAddress,
                    amount_in: amountIn,
                    amount_out_min: amountOutMin,
                    fee: fee
                });
                displayResult('swap-result', data);
            } catch (error) {
                displayResult('swap-result', error, true);
            }
        }
    </script>
</body>
</html>

